library(tidyverse)
read_xl("data/boing-boing-candy-2015.xlsx")
readxl("data/boing-boing-candy-2015.xlsx")
library(readxl)
readxl("data/boing-boing-candy-2015.xlsx")
library(readxl)
read_excel("data/boing-boing-candy-2015.xlsx", sheet = 1)
x2015_s1 <- read_excel("data/boing-boing-candy-2015.xlsx", sheet = 1)
View(x2015_s1)
excel_sheets("data/boing-boing-candy-2015.xlsx")
x2015 <- read_excel("data/boing-boing-candy-2015.xlsx", sheet = "Form Responses 1")
excel_sheets("data/boing-boing-candy-2016.xlsx")
excel_sheets("data/boing-boing-candy-2017.xlsx")
x2016 <- read_excel("data/boing-boing-candy-2016.xlsx", sheet = "Form Responses 1")
x2017 <- read_excel("data/boing-boing-candy-2017.xlsx", sheet = "responses (2) (1).csv")
View(x2017)
View(x2016)
library(tidyverse)
library(readxl)
excel_sheets("data/boing-boing-candy-2015.xlsx")
excel_sheets("data/boing-boing-candy-2016.xlsx")
excel_sheets("data/boing-boing-candy-2017.xlsx")
x2015 <- read_excel("data/boing-boing-candy-2015.xlsx", sheet = "Form Responses 1")
x2016 <- read_excel("data/boing-boing-candy-2016.xlsx", sheet = "Form Responses 1")
x2017 <- read_excel("data/boing-boing-candy-2017.xlsx", sheet = "responses (2) (1).csv")
colnames(x2015)
colnames(x2015)
colnames(x2016)
colnames(x2017)
ncol(x2015)
ncol(x2015) # 124 columns
colnames(x2015)
ncol(x2016)
colnames(x2016)
ncol(x2017)
colnames(x2017)
ncol(x2015) # 124 columns
colnames(x2015)
glimpse(x2015)
glimpse(x2015)
ncol(x2015) # 124 columns
colnames(x2015)
glimpse(x2015)
glimpse(x2016)
glimpse(x2017)
glimpse(x2017)
glimpse(x2016)
glimpse(x2015)
glimpse(x2015) # 5630 rows
View(x2015)
x2015 %>%
select(1:96,114,115)
# keep wanted columns (except 98-99)
x2015_subset <- x2015 %>%
select(1:96,114,115)
head(x2015_subset)
x2015_subset <- x2015 %>%
select(1:17,19-22,24-25,29-32,35-37,39-40,42-44,46-55,57-81,83-89,91-92,96,114,115)
x2015 %>%
select(1:17,19-22,24,25,29-32,35-37,39-40,42-44,46-55,57-81,83-89,91,92,96,114,115)
x2015_subset <- x2015 %>%
select(1:17,19:22,24,25,29:32,35:37,39:40,42:44,46:55,57:81,83:89,91,92,96,114,115)
head(x2015_subset) # 98 variables
library(janitor)
x2015_subset %>%
mutate(year = as.numeric(format(Timestamp, "%Y")))
x2015_subset %>%
mutate(year = as.numeric(format(Timestamp, "%Y")), .after = Timestamp)
x2015_subset %>%
mutate(year = Timestamp,
year = as.numeric(format(year, "%Y")))
x2015_subset %>%
mutate(year = as.numeric(format(Timestamp, "%Y")), .after = Timestamp)
# keep wanted columns (except 98-99)
x2015_subset <- x2015 %>%
select(1:17,19:22,24,25,29:32,35:37,39:40,42:44,46:55,57:81,83:89,91,92,96,114,115)
head(x2015_subset) # 82 variables
# rename variables about the rater & rating year
x2015_subset %>%
mutate(year = as.numeric(format(Timestamp, "%Y")), .after = Timestamp) %>%
select(-1)
x2015_subset %>%
mutate(year = as.numeric(format(Timestamp, "%Y")), .after = Timestamp) %>%
select(-1)
x2015_subset %>%
mutate(year = as.numeric(format(Timestamp, "%Y")), .after = Timestamp)
x2015_subset %>%
mutate(year = as.numeric(format(Timestamp, "%Y")), .after = Timestamp) %>%
select(-1)
x2015_subset %>%
mutate(year = as.numeric(format(Timestamp, "%Y")), .after = Timestamp) %>%
select(-"Timestamp")
x2015_subset %>%
rename(goes_trick_or_treating = "Are you going actually going trick or treating yourself?")
x2015_subset %>%
rename(age = "How old are you?",
goes_trick_or_treating = "Are you going actually going trick or treating yourself?",
year = "Timestamp") %>%
mutate(year = as.numeric(format(year, "%Y")))
x2015_subset %>%
rename(age = "How old are you?",
goes_trick_or_treating = "Are you going actually going trick or treating yourself?",
year = "Timestamp") %>%
mutate(year = as.numeric(format(year, "%Y")),
goes_trick_or_treating = as.logical(goes_trick_or_treating, T = "Yes", F = "No"))
x2015_subset %>%
rename(age = "How old are you?",
goes_trick_or_treating = "Are you going actually going trick or treating yourself?",
year = "Timestamp") %>%
mutate(age = as.numeric(age),
year = as.numeric(format(year, "%Y")))
x2015_subset %>%
rename(age = "How old are you?",
goes_trick_or_treating = "Are you going actually going trick or treating yourself?",
year = "Timestamp") %>%
mutate(age = as.integer(age),
year = as.numeric(format(year, "%Y")))
x2015_subset %>%
rename(age = "How old are you?",
goes_trick_or_treating = "Are you going actually going trick or treating yourself?",
year = "Timestamp") %>%
mutate(age = as.integer(age), # note coerces 9.0e22 in row 9 to NA
year = as.numeric(format(year, "%Y")),
gender = rep(NA_character_, nrow(x2015_subset))) # make empty column for gender (missing in this year's dataset)
x2015_subset %>%
rename(age = "How old are you?",
goes_trick_or_treating = "Are you going actually going trick or treating yourself?",
year = "Timestamp") %>%
mutate(age = as.integer(age), # note coerces 9.0e22 in row 9 to NA
year = as.numeric(format(year, "%Y")),
gender = rep(NA_character_, nrow(x2015_subset)), .after = age,
country = rep(NA_character_, nrow(x2015_subset)), .after = gender) # make empty columns for gender and country (missing in this year's dataset)
x2015_subset %>%
rename(age = "How old are you?",
goes_trick_or_treating = "Are you going actually going trick or treating yourself?",
year = "Timestamp") %>%
mutate(age = as.integer(age), # note coerces 9.0e22 in row 9 to NA
year = as.numeric(format(year, "%Y")),
gender = rep(NA_character_, nrow(x2015_subset)),
country = rep(NA_character_, nrow(x2015_subset)))
x2015_subset %>%
rename(age = "How old are you?",
goes_trick_or_treating = "Are you going actually going trick or treating yourself?",
year = "Timestamp") %>%
mutate(age = as.integer(age), # note coerces 9.0e22 in row 9 to NA
year = as.numeric(format(year, "%Y"))) %>%
# make empty columns for gender and country (missing in this year's dataset)
mutate(gender = rep(NA_character_, nrow(x2015_subset)), .after = age) %>%
mutate(country = rep(NA_character_, nrow(x2015_subset)), .after = gender)
x2015_subset %>%
rename(age = "How old are you?",
goes_trick_or_treating = "Are you going actually going trick or treating yourself?",
year = "Timestamp") %>%
mutate(age = as.integer(age), # note coerces 9.0e22 in row 9 to NA
year = as.numeric(format(year, "%Y")),
goes_trick_or_treating = as.logical(goes_trick_or_treating)) %>%
# make empty columns for gender and country (missing in this year's dataset)
mutate(gender = rep(NA_character_, nrow(x2015_subset)), .after = age) %>%
mutate(country = rep(NA_character_, nrow(x2015_subset)), .after = gender)
x2015_subset %>%
rename(age = "How old are you?",
goes_trick_or_treating = "Are you going actually going trick or treating yourself?",
year = "Timestamp") %>%
mutate(age = as.integer(age), # note coerces 9.0e22 in row 9 to NA
year = as.numeric(format(year, "%Y"))) %>%
# make empty columns for gender and country (missing in this year's dataset)
mutate(gender = rep(NA_character_, nrow(x2015_subset)), .after = age) %>%
mutate(country = rep(NA_character_, nrow(x2015_subset)), .after = gender)
x2015_subset %>%
rename(age = "How old are you?",
goes_trick_or_treating = "Are you going actually going trick or treating yourself?",
year = "Timestamp") %>%
mutate(age = as.integer(age), # note coerces 9.0e22 in row 9 to NA
year = as.numeric(format(year, "%Y"))) %>%
# make empty columns for gender and country (missing in this year's dataset)
mutate(gender = rep(NA_character_, nrow(x2015_subset)), .after = age) %>%
mutate(country = rep(NA_character_, nrow(x2015_subset)), .after = gender)
x2015_subset <- x2015_subset %>%
rename(age = "How old are you?",
goes_trick_or_treating = "Are you going actually going trick or treating yourself?",
year = "Timestamp") %>%
mutate(age = as.integer(age), # note coerces 9.0e22 in row 9 to NA
year = as.numeric(format(year, "%Y"))) %>%
# make empty columns for gender and country (missing in this year's dataset)
mutate(gender = rep(NA_character_, nrow(x2015_subset)), .after = age) %>%
mutate(country = rep(NA_character_, nrow(x2015_subset)), .after = gender)
dim(x2015_subset)
head(x2015_subset)
x2015_subset %>%
pivot_longer(cols = -c(year, age, gender, country, goes_trick_or_treating),
names_to = "candy_item",
values_to = "rating"
)
x2015_subset <- x2015_subset %>%
rename(age = "How old are you?",
goes_trick_or_treating = "Are you going actually going trick or treating yourself?",
year = "Timestamp") %>%
mutate(age = as.integer(age), # note coerces 9.0e22 in row 9 to NA
year = as.numeric(format(year, "%Y"))) %>%
# make empty columns for gender and country (missing in this year's dataset)
mutate(gender = rep(NA_character_, nrow(x2015_subset)), .after = age) %>%
mutate(country = rep(NA_character_, nrow(x2015_subset)), .after = gender) %>%
# make an id column to retain identifier for each person
# (currently as 1 row in the non-tidy data format)
mutate(id = c(1:5630), .before = age)
x2015_subset <- x2015 %>%
select(1:17,19:22,24,25,29:32,35:37,39:40,42:44,46:55,57:81,83:89,91,92,96,114,115)
x2015_subset %>%
rename(age = "How old are you?",
goes_trick_or_treating = "Are you going actually going trick or treating yourself?",
year = "Timestamp") %>%
mutate(age = as.integer(age), # note coerces 9.0e22 in row 9 to NA
year = as.numeric(format(year, "%Y"))) %>%
# make empty columns for gender and country (missing in this year's dataset)
mutate(gender = rep(NA_character_, nrow(x2015_subset)), .after = age) %>%
mutate(country = rep(NA_character_, nrow(x2015_subset)), .after = gender) %>%
# make an id column to retain identifier for each person
# (currently as 1 row in the non-tidy data format)
mutate(id = c(1:5630), .before = age)
x2015_subset_clean <- x2015_subset %>%
rename(age = "How old are you?",
goes_trick_or_treating = "Are you going actually going trick or treating yourself?",
year = "Timestamp") %>%
mutate(age = as.integer(age), # note coerces 9.0e22 in row 9 to NA
year = as.numeric(format(year, "%Y"))) %>%
# make empty columns for gender and country (missing in this year's dataset)
mutate(gender = rep(NA_character_, nrow(x2015_subset)), .after = age) %>%
mutate(country = rep(NA_character_, nrow(x2015_subset)), .after = gender) %>%
# make an id column to retain unique identifier for each person
mutate(id = c(1:5630), .before = age)
dim(x2015_subset_clean) # 84 cols x 5630 observations
head(x2015_subset_clean)
x2015_subset <- x2015 %>%
select(1:17,19:22,24,25,29:32,35:37,39:40,42:44,46:55,57:81,83:89,91,92,96,114,115)
head(x2015_subset) # 82 variables
x2015_subset_converted <- x2015_subset %>%
rename(age = "How old are you?",
goes_trick_or_treating = "Are you going actually going trick or treating yourself?",
year = "Timestamp") %>%
mutate(age = as.integer(age), # note coerces 9.0e22 in row 9 to NA
year = as.numeric(format(year, "%Y"))) %>%
# make empty columns for gender and country (missing in this year's dataset)
mutate(gender = rep(NA_character_, nrow(x2015_subset)), .after = age) %>%
mutate(country = rep(NA_character_, nrow(x2015_subset)), .after = gender) %>%
# make an id column to retain unique identifier for each person
mutate(id = c(1:5630), .before = age)
dim(x2015_subset_clean) # 85 cols x 5630 observations
head(x2015_subset_clean) # cols 1:6 are rater_info, 6_84 are candy items
dim(x2015_subset_converted) # 85 cols x 5630 observations
head(x2015_subset_converted)
x2015_subset_converted %>%
pivot_longer(cols = -c(year, id, age, gender, country, goes_trick_or_treating),
names_to = "candy_item",
values_to = "rating"
)
x2015_tidy <- x2015_subset_converted %>%
pivot_longer(cols = -c(year, id, age, gender, country, goes_trick_or_treating),
names_to = "candy_item",
values_to = "rating"
)
dim(x2015_tidy) # 85 cols x 5630 observations
head(x2015_tidy)
5630*79
head(x2015_tidy)
head(x2015_tidy, n = 20)
tail(x2015_tidy, n = 20)
x2015_tidy %>%
distinct(candy_item)
